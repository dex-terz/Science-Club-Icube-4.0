"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_primer_action_menu_experimental-action-menu-element_ts"],{4311:(e,t,i)=>{i.r(t),i.d(t,{default:()=>F});var s=i(69676);function n(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function r(e,t,i){if(!t.has(e))throw TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}function o(e,t){var i=r(e,t,"get");return i.get?i.get.call(e):i.value}function a(e,t,i){n(e,t),t.set(e,i)}function u(e,t,i){var s=r(e,t,"set");return!function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=i}}(e,s,i),i}function h(e,t,i){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return i}function l(e,t){n(e,t),t.add(e)}var c=new WeakMap,m=new WeakMap,d=new WeakMap,g=new WeakMap,b=new WeakMap,f=new WeakSet,p=new WeakSet,w=new WeakSet;let I=class ExperimentalActionMenuElement extends HTMLElement{get anchorAlign(){return this.getAttribute("data-anchor-align")||"start"}get anchorSide(){return this.getAttribute("data-anchor-side")||"outside-bottom"}get menu(){return this.querySelector('[role="menu"],[role="listbox"]')}get isListBox(){return!!this.menu&&"listbox"===this.menu.getAttribute("role")}get trigger(){return this.querySelector("button")}get overlay(){return this.querySelector(".Overlay")}get menuItems(){return this.menu?this.isListBox?Array.from(this.menu.querySelectorAll('[role="option"]')):Array.from(this.menu.querySelectorAll('[role="menuitem"],[role="menuitemcheckbox"],[role="menuitemradio"]')):null}get includeFragment(){return this.querySelector('[data-target~="action-menu.includeFragment"]')}get includeFragmentLoadingItem(){return this.querySelector('[data-target~="action-menu.includeFragmentLoadingItem"]')}get open(){return this.hasAttribute("open")}set open(e){let t=document.body.clientWidth,i=new ResizeObserver(e=>{for(let i of e)t!==i.contentRect.width&&this.open&&h(this,w,k).call(this)});if(e){if(this.open||!this.trigger||!this.menu)return;this.setAttribute("open",""),this.trigger.setAttribute("aria-expanded","true"),this.overlay?.removeAttribute("hidden"),this.menu.style.visibility="hidden",h(this,w,k).call(this),i.observe(document.body),this.menu.style.visibility="visible",this.includeFragmentLoadingItem&&(this.includeFragmentLoadingItem.tabIndex=0,this.includeFragmentLoadingItem.focus())}else{if(!this.open)return;this.removeAttribute("open"),this.trigger?.setAttribute("aria-expanded","false"),this.overlay?.setAttribute("hidden","true"),i.unobserve(document.body),setTimeout(()=>{document.activeElement===document.body&&this.trigger?.focus()},1)}}connectedCallback(){this.trigger&&h(this,f,y).call(this)}disconnectedCallback(){o(this,c).abort()}show(){this.open=!0}hide(){this.open=!1}setFocusToMenuItem(e){if(this.menuItems)for(let t of this.menuItems)t===e?(t.tabIndex=0,e.focus()):t.tabIndex=-1}setFocusToPreviousMenuItem(e){if(!this.menuItems)return;let t=null,i=null;return e===o(this,d)?t=o(this,g):(i=this.menuItems.indexOf(e),t=this.menuItems[i-1]),this.setFocusToMenuItem(t),t}setFocusToNextMenuItem(e){if(!this.menuItems)return;let t=null,i=null;return e===o(this,g)?t=o(this,d):(i=this.menuItems.indexOf(e),t=this.menuItems[i+1]),this.setFocusToMenuItem(t),t}setFocusByFirstCharacter(e,t){if(!this.menuItems)return;let i=null,s=null;!(t.length>1)&&(t=t.toLowerCase(),(i=this.menuItems.indexOf(e)+1)>=this.menuItems.length&&(i=0),-1===(s=o(this,m).indexOf(t,i))&&(s=o(this,m).indexOf(t,0)),s>-1&&this.setFocusToMenuItem(this.menuItems[s]))}buttonKeydown(e){let t=e.key,i=!1;switch(t){case" ":case"Enter":case"ArrowDown":case"Down":this.show(),this.setFocusToMenuItem(o(this,d)),i=!0;break;case"Esc":case"Escape":this.hide(),i=!0;break;case"Up":case"ArrowUp":this.show(),this.setFocusToMenuItem(o(this,g)),i=!0}i&&(e.stopPropagation(),e.preventDefault())}buttonClick(e){this.open?this.hide():(this.show(),this.setFocusToMenuItem(o(this,d))),e.stopPropagation(),e.preventDefault()}menuItemKeydown(e){let t=e.currentTarget,i=e.key,s=!1;function n(e){return 1===e.length&&e.match(/\S/)}if(!e.ctrlKey&&!e.altKey&&!e.metaKey){if(e.shiftKey)n(i)&&(this.setFocusByFirstCharacter(t,i),s=!0),"Tab"===e.key&&(this.trigger?.focus(),this.hide(),s=!0);else switch(i){case"Enter":case"Tab":this.selectMenuItem(t);break;case"Esc":case"Escape":this.hide(),s=!0;break;case"Up":case"ArrowUp":this.setFocusToPreviousMenuItem(t),s=!0;break;case"ArrowDown":case"Down":this.setFocusToNextMenuItem(t),s=!0;break;case"Home":case"PageUp":this.setFocusToMenuItem(o(this,d)),s=!0;break;case"End":case"PageDown":this.setFocusToMenuItem(o(this,g)),s=!0;break;default:n(i)&&(this.setFocusByFirstCharacter(t,i),s=!0)}s&&(e.stopPropagation(),e.preventDefault())}}menuItemClick(e){let t=e.currentTarget;if(this.isListBox&&this.menuItems&&t){for(let e of this.menuItems)if(e.contains(t)){this.selectMenuItem(e);return}}this.hide()}menuItemMouseover(e){e.currentTarget.focus()}backgroundMousedown(e){this&&!this.contains(e.target)&&this.open&&this.hide()}handleIncludeFragmentLoaded(){let{signal:e}=o(this,c);h(this,p,v).call(this,e),this.open&&this.setFocusToMenuItem(o(this,d))}async loadHTMLFragment(){if(o(this,b)){u(this,b,!1);try{return await this.includeFragment?.load()}catch{u(this,b,!0);return}}}selectMenuItem(e){if(this.isListBox&&this.menuItems)for(let t of this.menuItems){let i=t===e;if(t.setAttribute("aria-selected",i.toString()),i){let e=t.querySelector("input[type=radio]");null!==e&&(e.checked=i);let s=t.getAttribute("aria-label"),n=this.menu?.getAttribute("aria-labelledby"),r=n&&document.getElementById(n);r&&null!==s&&(r.textContent=s)}}this.hide()}constructor(...e){super(...e),l(this,f),l(this,p),l(this,w),a(this,c,{writable:!0,value:void 0}),a(this,m,{writable:!0,value:void 0}),a(this,d,{writable:!0,value:void 0}),a(this,g,{writable:!0,value:void 0}),a(this,b,{writable:!0,value:void 0}),u(this,b,!0)}};function y(){u(this,c,new AbortController);let{signal:e}=o(this,c);this.trigger&&this.menu&&(this.trigger.addEventListener("keydown",this.buttonKeydown.bind(this),{signal:e}),this.trigger.addEventListener("click",this.buttonClick.bind(this),{signal:e}),this.hasAttribute("preload")&&(this.trigger.addEventListener("mouseenter",this.loadHTMLFragment.bind(this),{signal:e}),this.trigger.addEventListener("focus",this.loadHTMLFragment.bind(this),{signal:e})),u(this,m,[]),h(this,p,v).call(this,e),this.includeFragment&&this.includeFragment.addEventListener("load",this.handleIncludeFragmentLoaded.bind(this)),window.addEventListener("mousedown",this.backgroundMousedown.bind(this),!0))}function v(e){if(this.menuItems)for(let t of this.menuItems)t.textContent&&o(this,m).push(t.textContent.trim()[0].toLowerCase()),t.addEventListener("keydown",this.menuItemKeydown.bind(this),{signal:e}),t.addEventListener("click",this.menuItemClick.bind(this),{signal:e}),t.addEventListener("mouseover",this.menuItemMouseover.bind(this),{signal:e}),o(this,d)||u(this,d,t),u(this,g,t)}function k(){if(!this.trigger||!this.menu)return;let e=this.querySelector("[data-menu-overlay]")||this.menu,t=this.trigger,{top:i,left:n}=(0,s.uG)(e,t,{side:this.anchorSide,align:this.anchorAlign});e.style.top=`${i}px`,e.style.left=`${n}px`}window.customElements.get("experimental-action-menu")||(window.ExperimentalActionMenuElement=I,window.customElements.define("experimental-action-menu",I));let F=I}}]);
//# sourceMappingURL=app_components_primer_action_menu_experimental-action-menu-element_ts-1088d54d0deb.js.map